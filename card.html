<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chúc Mừng Sinh Nhật</title>
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
<style>
*{ box-sizing:border-box; }
body{
    margin:0;
    min-height:100vh;
    background:#ffc0cb;
    font-family: 'Segoe UI', sans-serif;
    padding:20px;
    overflow-x:hidden;
}

.hearts{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:0;
}
.heart{
    position:absolute;
    font-size:22px;
    opacity:0.6;
    color:#e84d6d;
    animation: float 5s ease-in-out infinite;
}
.heart:nth-child(1){ left:8%; top:12%; animation-delay:0s; }
.heart:nth-child(2){ left:18%; bottom:20%; animation-delay:0.6s; }
.heart:nth-child(3){ right:12%; top:18%; animation-delay:1.2s; }
.heart:nth-child(4){ right:10%; bottom:18%; animation-delay:1.8s; }
.heart:nth-child(5){ left:10%; bottom:35%; animation-delay:2.4s; }
.heart:nth-child(6){ right:22%; top:35%; animation-delay:0.3s; }
.heart:nth-child(7){ left:28%; top:8%; animation-delay:0.9s; }
.heart:nth-child(8){ right:18%; bottom:40%; animation-delay:1.5s; }
@keyframes float{
    0%,100%{ transform: translateY(0); }
    50%{ transform: translateY(-10px); }
}

.page-wrap{ position:relative; z-index:1; max-width:480px; margin:0 auto; text-align:center; }
.title{
    font-size:1.4rem;
    font-weight:700;
    color:#6b2d4a;
    text-transform:uppercase;
    letter-spacing:1px;
    margin:0 0 6px 0;
}
.subtitle{
    font-family: 'Dancing Script', cursive;
    font-size:1.5rem;
    font-weight:600;
    color:#6b2d4a;
    margin:0 0 20px 0;
    letter-spacing:0.5px;
}

.hint{
    font-size:0.85rem;
    color:rgba(107,45,74,0.7);
    margin-top:12px;
}

/* Card: bìa = 1 ảnh maid.jpg full, click lật phải sang trái, bên trong trái = ảnh, phải = lời chúc */
.card-wrap{
    perspective:1800px;
    margin:20px auto;
    width:75%;
    max-width:420px;
}
.card-spread{
    position:relative;
    display:flex;
    min-height:350px;
    border-radius:12px;
    overflow:hidden;
    box-shadow:0 12px 40px rgba(0,0,0,0.2);
}

/* Bên trong: chỉ ảnh + nút, không khung trắng */
.inside{
    width:100%;
    display:flex;
    flex-direction:column;
    align-items:center;
    background:transparent;
    padding:0;
}
.inside-img{
    width:100%;
    display:block;
    vertical-align:top;
    min-height:300px;
    object-fit:contain;
}

/* Bìa = 1 ảnh full (maid.jpg), lật từ phải sang trái */
.cover{
    position:absolute;
    left:0;
    top:0;
    width:100%;
    height:100%;
    transform-style: preserve-3d;
    transform-origin: left center;
    cursor:pointer;
    z-index:2;
}
.cover.flipped{
    animation: cover-flip 1.1s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
    pointer-events:none;
}
@keyframes cover-flip{
    0%{ transform: rotateY(0) rotateX(0deg); }
    25%{ transform: rotateY(-45deg) rotateX(3deg); }
    50%{ transform: rotateY(-90deg) rotateX(4deg); }
    75%{ transform: rotateY(-135deg) rotateX(2deg); }
    100%{ transform: rotateY(-180deg) rotateX(0deg); }
}
.cover-front,
.cover-back{
    position:absolute;
    inset:0;
    -webkit-backface-visibility:hidden;
    backface-visibility:hidden;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:hidden;
}
.cover-front{
    background:#fef6f8;
}
.cover-front img{
    width:100%;
    height:100%;
    object-fit:cover;
}
.cover-back{
    background: linear-gradient(135deg, #f5e6ea 0%, #ebe0e4 100%);
    transform: rotateY(180deg);
}

.card-body h3{
    margin:0 0 12px 0;
    font-size:0.9rem;
    color:#6b2d4a;
    text-transform:uppercase;
}
.card-body p{
    margin:0 0 8px 0;
    font-size:0.9rem;
    line-height:1.6;
    color:#4a2d3a;
}
.card-body p:last-child{ margin-bottom:0; }

.view{ display:none; }
.view.active{ display:block; }

/* Nút lật sang trang quà - tách ra ngoài, chỉ hiện sau khi mở bìa */
.btn-next-wrap{
    margin-top:20px;
    text-align:center;
    opacity:0;
    pointer-events:none;
    transition: opacity 0.3s ease;
}
.btn-next-wrap.show{
    opacity:1;
    pointer-events:auto;
}
.btn-next-page{
    display:inline-block;
    margin:0 auto;
    padding:14px 32px;
    background: linear-gradient(180deg, #9b59b6, #8e44ad);
    color:#fff;
    font-size:1rem;
    font-weight:600;
    border:none;
    border-radius:24px;
    cursor:pointer;
    box-shadow:0 4px 15px rgba(142,68,173,0.4);
    transition: transform 0.2s;
}
.btn-next-page:hover{ transform: scale(1.03); }

/* Trang quà */
.gift-page{
    max-width:420px;
    margin:20px auto;
    padding:20px 0;
}
.gift-box-wrap{
    position:relative;
    width:240px;
    height:240px;
    margin:0 auto 28px;
    perspective:400px;
}
.gift-box-wrap .gift-body,
.gift-box-wrap .gift-lid{
    position:absolute;
    left:50%;
    transform-origin: center bottom;
    transition: transform 0.6s ease, opacity 0.5s;
}
.gift-body{
    bottom:0;
    width:160px;
    height:120px;
    margin-left:-80px;
    background: linear-gradient(180deg, #e74c3c, #c0392b);
    border-radius:0 0 10px 10px;
    box-shadow: inset 0 -6px 0 rgba(0,0,0,0.2);
}
.gift-body::before{
    content:'';
    position:absolute;
    top:50%;
    left:0;
    right:0;
    height:24px;
    margin-top:-12px;
    background: #fff;
    opacity:0.9;
}
.gift-lid{
    bottom:120px;
    width:175px;
    height:50px;
    margin-left:-87px;
    background: linear-gradient(180deg, #c0392b, #a93226);
    border-radius:10px 10px 0 0;
    box-shadow: 0 -4px 12px rgba(0,0,0,0.2);
}
.gift-box-wrap.opened .gift-lid{
    transform: rotateX(-110deg);
    pointer-events:none;
}
.gift-box-wrap.opened .gift-body{
    transform: scale(0.92);
    opacity:0.25;
}
.btn-open-gift{
    display:inline-block;
    padding:14px 32px;
    background: linear-gradient(180deg, #9b59b6, #8e44ad);
    color:#fff;
    font-size:1.05rem;
    font-weight:600;
    border:none;
    border-radius:28px;
    cursor:pointer;
    box-shadow:0 4px 15px rgba(142,68,173,0.4);
    transition: transform 0.2s;
}
.btn-open-gift:hover{ transform: scale(1.05); }

/* Ẩn hộp quà + nút sau khi mở (transition mượt) */
.gift-box-wrap,
.btn-open-gift{
    transition: opacity 0.5s ease, transform 0.5s ease;
}
.gift-box-wrap.hide,
.btn-open-gift.hide{
    opacity:0;
    pointer-events:none;
    visibility:hidden;
}
.gift-box-wrap.hide{ transform: scale(0.9); }

/* 1️⃣ Viewport (khung nhìn) */
.marquee{
    display:none;
    width:100vw;
    height:100vh;
    overflow:hidden;
    position:relative;
    background:#f6aeb8;
}
.marquee.show{
    display:block;
}
.marquee.fullscreen{
    position:fixed;
    inset:0;
    z-index:50;
}

/* 2️⃣ Canvas lớn gấp 2 màn hình - 2 layer */
.canvas{
    position:absolute;
    width:200vw;
    height:100vh;
    top:0;
    left:0;
    will-change:transform;
}
.canvas-layer-1{
    animation: move 40s linear infinite;
}
.canvas-layer-2{
    animation: move 25s linear infinite;
}

/* 3️⃣ Ảnh rải loạn (position absolute) */
.canvas img{
    position:absolute;
    width:140px;
    height:180px;
    object-fit:cover;
    border-radius:16px;
    box-shadow:0 8px 20px rgba(0,0,0,0.2);
}
.canvas-layer-2 img{
    width:100px;
    height:140px;
    opacity:0.85;
}

/* 4️⃣ Animation trôi ngang - loop -50% (duplicate content) */
@keyframes move{
    from{ transform: translateX(0); }
    to{ transform: translateX(-50%); }
}

#canvas-confetti{ position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:100; }
</style>
</head>
<body>

<div class="hearts" aria-hidden="true">
    <span class="heart">❤</span><span class="heart">❤</span><span class="heart">❤</span><span class="heart">❤</span>
    <span class="heart">❤</span><span class="heart">❤</span><span class="heart">❤</span><span class="heart">❤</span>
</div>

<div class="page-wrap">
    <h1 class="title">Chúc mừng sinh nhật cô hầu gái!</h1>
    <p class="subtitle">MISOUWU</p>

    <div id="cardView" class="view active">
        <div class="card-wrap">
            <div class="card-spread">
                <div class="inside">
                    <img src="cmsn.png" class="inside-img" alt="Lời chúc sinh nhật">
                </div>
                <div class="cover" id="cover" title="Click để mở thiệp">
                    <div class="cover-front">
                        <img src="maid.jpg" alt="">
                    </div>
                    <div class="cover-back"></div>
                </div>
            </div>
        </div>
        <div class="btn-next-wrap" id="btnNextWrap">
            <button type="button" class="btn-next-page" id="btnNextPage">Bất ngờ còn ở phía sau</button>
        </div>
    </div>

    <div id="giftView" class="view">
        <div class="gift-page">
            <div class="gift-box-wrap" id="giftBoxWrap">
                <div class="gift-body"></div>
                <div class="gift-lid"></div>
            </div>
            <button type="button" class="btn-open-gift" id="btnOpenGift">Mở quà</button>
            <div class="marquee" id="marquee">
                <div class="canvas canvas-layer-1" id="canvasLayer1">
                    <img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=1" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=2" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=3" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=4" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=5" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=6" alt="">
                    <img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=1" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=2" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=3" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=4" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=5" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=6" alt="">
                </div>
                <div class="canvas canvas-layer-2" id="canvasLayer2">
                    <img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=1" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=2" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=3" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=4" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=5" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=6" alt="">
                    <img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=1" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=2" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=3" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=4" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=5" alt=""><img src="https://placehold.co/140x180/ffb3c6/8b3a5c?text=6" alt="">
                </div>
            </div>
        </div>
    </div>
</div>

<audio id="bgm" loop>
    <source src="anhdomiso.mp3" type="audio/mpeg">
</audio>

<script>
var cover = document.getElementById("cover");
var bgm = document.getElementById("bgm");
var btnNextPage = document.getElementById("btnNextPage");
var btnNextWrap = document.getElementById("btnNextWrap");
var cardView = document.getElementById("cardView");
var giftView = document.getElementById("giftView");
var btnOpenGift = document.getElementById("btnOpenGift");
var giftBoxWrap = document.getElementById("giftBoxWrap");
var marquee = document.getElementById("marquee");
var canvasLayer1 = document.getElementById("canvasLayer1");
var canvasLayer2 = document.getElementById("canvasLayer2");

function randomizeMarqueePositions(canvasEl){
    var images = canvasEl.querySelectorAll("img");
    var n = images.length;
    images.forEach(function(img, i){
        img.style.top = Math.random() * 80 + "%";
        img.style.left = (i < n/2 ? Math.random() * 90 : 100 + Math.random() * 80) + "%";
    });
}

cover.onclick = function(){
    if(cover.classList.contains("flipped")) return;
    cover.classList.add("flipped");
    setTimeout(function(){
        confetti({ particleCount: 120, spread: 80, origin: { y: 0.6 } });
        setTimeout(function(){ confetti({ particleCount: 80, spread: 100, origin: { y: 0.5 } }); }, 300);
        if(bgm.src) bgm.play().catch(function(){});
        btnNextWrap.classList.add("show");
    }, 1150);
};

btnNextPage.onclick = function(){
    cardView.classList.remove("active");
    giftView.classList.add("active");
};

btnOpenGift.onclick = function(){
    if(giftBoxWrap.classList.contains("opened")) return;
    giftBoxWrap.classList.add("opened");
    randomizeMarqueePositions(canvasLayer1);
    randomizeMarqueePositions(canvasLayer2);
    setTimeout(function(){
        marquee.classList.add("show");
        marquee.classList.add("fullscreen");
        giftBoxWrap.classList.add("hide");
        btnOpenGift.classList.add("hide");
    }, 650);
};
</script>
</body>
</html>
